<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanctum Battle Arena</title>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            font-family: 'IM Fell English SC', serif;
            color: #f0e6d2;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .arena-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .arena-title {
            font-size: 3rem;
            background: linear-gradient(45deg, #ffd700, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            margin-bottom: 10px;
            animation: titlePulse 3s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .battle-arena {
            display: flex;
            justify-content: space-around;
            align-items: center;
            width: 100%;
            max-width: 1000px;
            margin: 30px 0;
            position: relative;
        }

        .creature-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .creature-card {
            width: 320px;
            height: 450px;
            background-size: cover;
            background-position: center;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.6);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .creature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 60%);
            z-index: 1;
        }

        .creature-info {
            padding: 25px;
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .creature-name {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .creature-tier {
            font-size: 0.9rem;
            margin-bottom: 15px;
            padding: 5px 10px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
        }

        .tier-protector { background: linear-gradient(45deg, #4CAF50, #81C784); }
        .tier-regent { background: linear-gradient(45deg, #2196F3, #64B5F6); }
        .tier-shield { background: linear-gradient(45deg, #FF9800, #FFB74D); }
        .tier-champion { background: linear-gradient(45deg, #9C27B0, #BA68C8); }
        .tier-dissonant { background: linear-gradient(45deg, #F44336, #FF5722); }

        .creature-stats {
            background: rgba(20, 15, 25, 0.9);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .health-bar-container {
            margin: 15px 0;
        }

        .health-bar {
            height: 25px;
            background: rgba(50,50,50,0.8);
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid rgba(255,255,255,0.2);
            position: relative;
        }

        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            width: 100%;
            transition: width 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            overflow: hidden;
        }

        .health-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: healthShine 2s infinite;
        }

        @keyframes healthShine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .health-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            font-size: 0.8rem;
        }

        .vs-indicator {
            font-size: 3rem;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            animation: vsGlow 2s ease-in-out infinite alternate;
            z-index: 10;
        }

        @keyframes vsGlow {
            from { text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 0 0 10px #ffd700; }
            to { text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 0 0 20px #ffd700, 0 0 30px #ffd700; }
        }

        .battle-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
        }

        .creature-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .selector-dropdown {
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid #4ecdc4;
            background: rgba(30, 30, 50, 0.9);
            color: #f0e6d2;
            font-family: 'IM Fell English SC', serif;
            font-size: 1rem;
            cursor: pointer;
        }

        .battle-btn {
            background: linear-gradient(45deg, #6c5ce7, #a29bfe);
            color: white;
            border: none;
            padding: 15px 35px;
            font-size: 1.3rem;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'IM Fell English SC', serif;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4);
            position: relative;
            overflow: hidden;
        }

        .battle-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .battle-btn:hover {
            background: linear-gradient(45deg, #ff7675, #fd79a8);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 118, 117, 0.4);
        }

        .battle-btn:hover::before {
            left: 100%;
        }

        .battle-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        .battle-log {
            background: rgba(0,0,0,0.8);
            color: #f0e6d2;
            padding: 25px;
            border-radius: 15px;
            width: 100%;
            max-width: 900px;
            min-height: 250px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
            font-size: 1.1rem;
            line-height: 1.8;
            border: 2px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }

        .battle-log::-webkit-scrollbar {
            width: 8px;
        }

        .battle-log::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }

        .battle-log::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
        }

        .log-entry {
            margin: 8px 0;
            padding: 5px 0;
            border-left: 3px solid transparent;
            padding-left: 10px;
            animation: logAppear 0.5s ease-in;
        }

        .log-attack { border-left-color: #ff6b6b; }
        .log-special { border-left-color: #ffd700; }
        .log-damage { border-left-color: #ff8a80; }
        .log-victory { border-left-color: #4caf50; }

        @keyframes logAppear {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Battle Effect Animations */
        .floating-damage {
            position: absolute;
            font-size: 2rem;
            font-weight: bold;
            z-index: 1000;
            pointer-events: none;
            animation: floatUp 2s ease-out forwards;
        }

        .damage-normal { color: #ff6b6b; }
        .damage-special { color: #ffd700; text-shadow: 0 0 10px #ffd700; }
        .damage-critical { color: #ff4757; text-shadow: 0 0 15px #ff4757; }
        .damage-heal { color: #2ed573; text-shadow: 0 0 10px #2ed573; }

        @keyframes floatUp {
            0% { 
                opacity: 1; 
                transform: translateY(0px) scale(1);
            }
            100% { 
                opacity: 0; 
                transform: translateY(-120px) scale(1.3);
            }
        }

        .card-hit {
            animation: cardShake 0.6s ease-in-out;
        }

        .card-special {
            animation: cardSpecialGlow 1.5s ease-in-out;
        }

        .card-dissonant {
            animation: dissonantPower 2s ease-in-out;
        }

        @keyframes cardShake {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(-8px) rotate(-2deg); }
            75% { transform: translateX(8px) rotate(2deg); }
        }

        @keyframes cardSpecialGlow {
            0%, 100% { 
                box-shadow: 0 15px 35px rgba(0,0,0,0.6);
                filter: brightness(1);
            }
            50% { 
                box-shadow: 0 0 40px rgba(255, 215, 0, 0.8), 0 15px 35px rgba(0,0,0,0.6);
                filter: brightness(1.3);
            }
        }

        @keyframes dissonantPower {
            0%, 100% { 
                transform: scale(1);
                filter: brightness(1) hue-rotate(0deg);
            }
            25% { 
                transform: scale(1.05);
                filter: brightness(1.5) hue-rotate(90deg);
            }
            50% { 
                transform: scale(1.1);
                filter: brightness(2) hue-rotate(180deg);
            }
            75% { 
                transform: scale(1.05);
                filter: brightness(1.5) hue-rotate(270deg);
            }
        }

        .screen-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(255, 255, 255, 0.8);
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            animation: flashEffect 0.5s ease-out;
        }

        @keyframes flashEffect {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }

        .screen-shake {
            animation: screenShake 0.8s ease-in-out;
        }

        @keyframes screenShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        .particle-explosion {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 100;
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #ffd700;
            border-radius: 50%;
            animation: explode 1s ease-out forwards;
        }

        @keyframes explode {
            0% {
                opacity: 1;
                transform: scale(1) translate(0, 0);
            }
            100% {
                opacity: 0;
                transform: scale(0) translate(var(--dx), var(--dy));
            }
        }

        .loading-spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 4px solid #4ecdc4;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .battle-arena {
                flex-direction: column;
                gap: 30px;
            }
            
            .creature-card {
                width: 280px;
                height: 400px;
            }
            
            .arena-title {
                font-size: 2rem;
            }
            
            .vs-indicator {
                font-size: 2rem;
                transform: rotate(90deg);
            }
        }
    </style>
</head>
<body>
    <div class="arena-header">
        <h1 class="arena-title">⚔️ SANCTUM BATTLE ARENA ⚔️</h1>
        <p>Choose your creatures and witness the power of evolution!</p>
    </div>
    
    <div class="creature-selector">
        <div><!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>PET Battle Arena</title>
                <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
                <style>
                    body {
                        background-color: #111;
                        font-family: 'IM Fell English SC', serif;
                        color: #f0e6d2;
                        padding: 20px;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                    }
            
                    .battle-arena {
                        display: flex;
                        justify-content: space-around;
                        width: 100%;
                        max-width: 900px;
                        margin: 30px 0;
                    }
            
                    .pet-card {
                        width: 300px;
                        height: 400px;
                        background-size: cover;
                        background-position: center;
                        border-radius: 12px;
                        box-shadow: 0 10px 25px rgba(0,0,0,0.5);
                        display: flex;
                        flex-direction: column;
                        justify-content: flex-end;
                        position: relative;
                        overflow: hidden;
                    }
            
                    .pet-card::before {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 50%);
                    }
            
                    .pet-info {
                        padding: 20px;
                        position: relative;
                        z-index: 2;
                        text-align: center;
                    }
            
                    .pet-name {
                        font-size: 1.8rem;
                        margin-bottom: 10px;
                        color: #fff;
                        text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
                    }
            
                    .pet-stats {
                        background-color: rgba(30, 20, 19, 0.85);
                        padding: 15px;
                        border-radius: 8px;
                        backdrop-filter: blur(2px);
                    }
            
                    .stat {
                        display: flex;
                        justify-content: space-between;
                        margin-bottom: 8px;
                    }
            
                    .battle-btn {
                        background-color: #6c5ce7;
                        color: white;
                        border: none;
                        padding: 12px 25px;
                        font-size: 1.2rem;
                        border-radius: 5px;
                        cursor: pointer;
                        margin: 20px 0;
                        font-family: 'IM Fell English SC', serif;
                        transition: all 0.3s ease;
                    }
            
                    .battle-btn:hover {
                        background-color: #ff7675;
                        transform: scale(1.05);
                    }
            
                    .battle-log {
                        background-color: rgba(0,0,0,0.7);
                        color: white;
                        padding: 15px;
                        border-radius: 8px;
                        width: 100%;
                        max-width: 800px;
                        min-height: 200px;
                        max-height: 300px;
                        overflow-y: auto;
                        margin-top: 20px;
                        font-size: 1.1rem;
                        line-height: 1.6;
                    }
            
                    .battle-log p {
                        margin: 5px 0;
                    }
            
                    .health-bar {
                        height: 20px;
                        background-color: #333;
                        border-radius: 10px;
                        margin: 10px 0;
                        overflow: hidden;
                    }
            
                    .health-fill {
                        height: 100%;
                        background-color: #ff7675;
                        width: 100%;
                        transition: width 0.5s ease;
                    }
                </style>
            </head>
            <body>
                <h1>Dissonant PET Battle</h1>
                
                <div class="battle-arena">
                    <!-- Dissonant Tiger Card -->
                    <div class="pet-card" style="background-image: url('images/disTiger.jpeg')">
                        <div class="pet-info">
                            <div class="pet-name">Dissonant Tiger</div>
                            <div class="pet-stats">
                                <div class="stat"><span>HP:</span> <span id="tiger-hp">120</span></div>
                                <div class="health-bar">
                                    <div class="health-fill" id="tiger-health"></div>
                                </div>
                                <div class="stat"><span>Attack:</span> <span>40</span></div>
                                <div class="stat"><span>Special:</span> <span>Celestial Claw (60)</span></div>
                            </div>
                        </div>
                    </div>
            
                    <div style="display: flex; align-items: center; font-size: 2rem; padding: 0 20px;">
                        VS
                    </div>
            
                    <!-- Dissonant Arabian Card -->
                    <div class="pet-card" style="background-image: url('images/disArabian.jpeg')">
                        <div class="pet-info">
                            <div class="pet-name">Dissonant Arabian</div>
                            <div class="pet-stats"><!DOCTYPE html>
                                <html lang="en">
                                <head>
                                    <meta charset="UTF-8">
                                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                                    <title>PET Battle Arena</title>
                                    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
                                    <style>
                                        body {
                                            background-color: #111;
                                            font-family: 'IM Fell English SC', serif;
                                            color: #f0e6d2;
                                            padding: 20px;
                                            display: flex;
                                            flex-direction: column;
                                            align-items: center;
                                        }
                                
                                        .battle-arena {
                                            display: flex;
                                            justify-content: space-around;
                                            width: 100%;
                                            max-width: 900px;
                                            margin: 30px 0;
                                        }
                                
                                        .pet-card {
                                            width: 300px;
                                            height: 400px;
                                            background-size: cover;
                                            background-position: center;
                                            border-radius: 12px;
                                            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
                                            display: flex;
                                            flex-direction: column;
                                            justify-content: flex-end;
                                            position: relative;
                                            overflow: hidden;
                                        }
                                
                                        .pet-card::before {
                                            content: '';
                                            position: absolute;
                                            top: 0;
                                            left: 0;
                                            right: 0;
                                            bottom: 0;
                                            background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 50%);
                                        }
                                
                                        .pet-info {
                                            padding: 20px;
                                            position: relative;
                                            z-index: 2;
                                            text-align: center;
                                        }
                                
                                        .pet-name {
                                            font-size: 1.8rem;
                                            margin-bottom: 10px;
                                            color: #fff;
                                            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
                                        }
                                
                                        .pet-stats {
                                            background-color: rgba(30, 20, 19, 0.85);
                                            padding: 15px;
                                            border-radius: 8px;
                                            backdrop-filter: blur(2px);
                                        }
                                
                                        .stat {
                                            display: flex;
                                            justify-content: space-between;
                                            margin-bottom: 8px;
                                        }
                                
                                        .battle-btn {
                                            background-color: #6c5ce7;
                                            color: white;
                                            border: none;
                                            padding: 12px 25px;
                                            font-size: 1.2rem;
                                            border-radius: 5px;
                                            cursor: pointer;
                                            margin: 20px 0;
                                            font-family: 'IM Fell English SC', serif;
                                            transition: all 0.3s ease;
                                        }
                                
                                        .battle-btn:hover {
                                            background-color: #ff7675;
                                            transform: scale(1.05);
                                        }
                                
                                        .battle-log {
                                            background-color: rgba(0,0,0,0.7);
                                            color: white;
                                            padding: 15px;
                                            border-radius: 8px;
                                            width: 100%;
                                            max-width: 800px;
                                            min-height: 200px;
                                            max-height: 300px;
                                            overflow-y: auto;
                                            margin-top: 20px;
                                            font-size: 1.1rem;
                                            line-height: 1.6;
                                        }
                                
                                        .battle-log p {
                                            margin: 5px 0;
                                        }
                                
                                        .health-bar {
                                            height: 20px;
                                            background-color: #333;
                                            border-radius: 10px;
                                            margin: 10px 0;
                                            overflow: hidden;
                                        }
                                
                                        .health-fill {
                                            height: 100%;
                                            background-color: #ff7675;
                                            width: 100%;
                                            transition: width 0.5s ease;
                                        }
                                    </style>
                                </head>
                                <body>
                                    <h1>Dissonant PET Battle</h1>
                                    
                                    <div class="battle-arena">
                                        <!-- Dissonant Tiger Card -->
                                        <div class="pet-card" style="background-image: url('images/disTiger.jpeg')">
                                            <div class="pet-info">
                                                <div class="pet-name">Dissonant Tiger</div>
                                                <div class="pet-stats">
                                                    <div class="stat"><span>HP:</span> <span id="tiger-hp">120</span></div>
                                                    <div class="health-bar">
                                                        <div class="health-fill" id="tiger-health"></div>
                                                    </div>
                                                    <div class="stat"><span>Attack:</span> <span>40</span></div>
                                                    <div class="stat"><span>Special:</span> <span>Celestial Claw (60)</span></div>
                                                </div>
                                            </div>
                                        </div>
                                
                                        <div style="display: flex; align-items: center; font-size: 2rem; padding: 0 20px;">
                                            VS
                                        </div>
                                
                                        <!-- Dissonant Arabian Card -->
                                        <div class="pet-card" style="background-image: url('images/disArabian.jpeg')">
                                            <div class="pet-info">
                                                <div class="pet-name">Dissonant Arabian</div>
                                                <div class="pet-stats">
                                                    <div class="stat"><span>HP:</span> <span id="arabian-hp">100</span></div>
                                                    <div class="health-bar">
                                                        <div class="health-fill" id="arabian-health"></div>
                                                    </div>
                                                    <div class="stat"><span>Attack:</span> <span>35</span></div>
                                                    <div class="stat"><span>Special:</span> <span>Winged Strike (70)</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                
                                    <button id="battle-btn" class="battle-btn">Start Battle!</button>
                                    
                                    <div id="battle-log" class="battle-log">
                                        <p>Click "Start Battle!" to begin...</p>
                                    </div>
                                
                                    <script>
                                        // Card stats
                                        const cards = {
                                            dissonantTiger: {
                                                name: "Dissonant Tiger",
                                                maxHp: 120,
                                                hp: 120,
                                                attack: 40,
                                                special: "Celestial Claw",
                                                specialDamage: 60
                                            },
                                            dissonantArabian: {
                                                name: "Dissonant Arabian",
                                                maxHp: 100,
                                                hp: 100,
                                                attack: 35,
                                                special: "Winged Strike",
                                                specialDamage: 70
                                            }
                                        };
                                
                                        // DOM elements
                                        const battleBtn = document.getElementById('battle-btn');
                                        const battleLog = document.getElementById('battle-log');
                                        const tigerHpDisplay = document.getElementById('tiger-hp');
                                        const arabianHpDisplay = document.getElementById('arabian-hp');
                                        const tigerHealthBar = document.getElementById('tiger-health');
                                        const arabianHealthBar = document.getElementById('arabian-health');
                                
                                        // Initialize health bars
                                        updateHealthBars();
                                
                                        // Battle function
                                        function battle() {
                                            // Reset battle
                                            battleLog.innerHTML = '<p>⚔️ Battle started! ⚔️</p>';
                                            resetBattle();
                                            
                                            // Disable button during battle
                                            battleBtn.disabled = true;
                                            battleBtn.textContent = "Battle in progress...";
                                            
                                            // Battle loop
                                            let turn = 0;
                                            const maxTurns = 20;
                                            
                                            const battleInterval = setInterval(() => {
                                                turn++;
                                                battleLog.innerHTML += `<p>--- Turn ${turn} ---</p>`;
                                                
                                                // Tiger attacks
                                                const tigerAttack = Math.random() < 0.3 ? 
                                                    useSpecial(cards.dissonantTiger, cards.dissonantArabian) : 
                                                    normalAttack(cards.dissonantTiger, cards.dissonantArabian);
                                                battleLog.innerHTML += tigerAttack;
                                                updateHealthBars();
                                                
                                                // Check if Arabian is defeated
                                                if(cards.dissonantArabian.hp <= 0) {
                                                    endBattle(cards.dissonantTiger, cards.dissonantArabian);
                                                    clearInterval(battleInterval);
                                                    return;
                                                }
                                                
                                                // Arabian attacks
                                                const arabianAttack = Math.random() < 0.3 ? 
                                                    useSpecial(cards.dissonantArabian, cards.dissonantTiger) : 
                                                    normalAttack(cards.dissonantArabian, cards.dissonantTiger);
                                                battleLog.innerHTML += arabianAttack;
                                                updateHealthBars();
                                                
                                                // Check if Tiger is defeated
                                                if(cards.dissonantTiger.hp <= 0) {
                                                    endBattle(cards.dissonantArabian, cards.dissonantTiger);
                                                    clearInterval(battleInterval);
                                                    return;
                                                }
                                                
                                                // Check max turns
                                                if(turn >= maxTurns) {
                                                    endBattle(null, null); // Draw
                                                    clearInterval(battleInterval);
                                                }
                                                
                                                // Auto-scroll log
                                                battleLog.scrollTop = battleLog.scrollHeight;
                                            }, 1500); // 1.5 seconds per turn
                                        }
                                
                                        // Helper functions
                                        function normalAttack(attacker, defender) {
                                            const damage = Math.floor(attacker.attack * (0.8 + Math.random() * 0.4));
                                            defender.hp = Math.max(0, defender.hp - damage);
                                            return `<p>${attacker.name} attacks for ${damage} damage!</p>`;
                                        }
                                
                                        function useSpecial(attacker, defender) {
                                            const damage = Math.floor(attacker.specialDamage * (0.8 + Math.random() * 0.4));
                                            defender.hp = Math.max(0, defender.hp - damage);
                                            return `<p>✨ ${attacker.name} uses <strong>${attacker.special}</strong> for ${damage} damage!</p>`;
                                        }
                                
                                        function updateHealthBars() {
                                            // Update HP text
                                            tigerHpDisplay.textContent = cards.dissonantTiger.hp;
                                            arabianHpDisplay.textContent = cards.dissonantArabian.hp;
                                            
                                            // Update health bars
                                            tigerHealthBar.style.width = `${(cards.dissonantTiger.hp / cards.dissonantTiger.maxHp) * 100}%`;
                                            arabianHealthBar.style.width = `${(cards.dissonantArabian.hp / cards.dissonantArabian.maxHp) * 100}%`;
                                            
                                            // Change color based on health
                                            tigerHealthBar.style.backgroundColor = getHealthColor(cards.dissonantTiger.hp, cards.dissonantTiger.maxHp);
                                            arabianHealthBar.style.backgroundColor = getHealthColor(cards.dissonantArabian.hp, cards.dissonantArabian.maxHp);
                                        }
                                
                                        function getHealthColor(currentHp, maxHp) {
                                            const percent = (currentHp / maxHp) * 100;
                                            if(percent > 60) return "#4CAF50"; // Green
                                            if(percent > 30) return "#FFC107"; // Yellow
                                            return "#F44336"; // Red
                                        }
                                        <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PET Battle Arena</title>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #111;
            font-family: 'IM Fell English SC', serif;
            color: #f0e6d2;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .battle-arena {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 900px;
            margin: 30px 0;
        }

        .pet-card {
            width: 300px;
            height: 400px;
            background-size: cover;
            background-position: center;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            position: relative;
            overflow: hidden;
        }

        .pet-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 50%);
        }

        .pet-info {
            padding: 20px;
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .pet-name {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        }

        .pet-stats {
            background-color: rgba(30, 20, 19, 0.85);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(2px);
        }

        .stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .battle-btn {
            background-color: #6c5ce7;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.2rem;
            border-radius: 5px;
            cursor: pointer;
            margin: 20px 0;
            font-family: 'IM Fell English SC', serif;
            transition: all 0.3s ease;
        }

        .battle-btn:hover {
            background-color: #ff7675;
            transform: scale(1.05);
        }

        .battle-log {
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 15px;
            border-radius: 8px;
            width: 100%;
            max-width: 800px;
            min-height: 200px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .battle-log p {
            margin: 5px 0;
        }

        .health-bar {
            height: 20px;
            background-color: #333;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .health-fill {
            height: 100%;
            background-color: #ff7675;
            width: 100%;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <h1>Dissonant PET Battle</h1>
    
    <div class="battle-arena">
        <!-- Dissonant Tiger Card -->
        <div class="pet-card" style="background-image: url('images/disTiger.jpeg')">
            <div class="pet-info">
                <div class="pet-name">Dissonant Tiger</div>
                <div class="pet-stats">
                    <div class="stat"><span>HP:</span> <span id="tiger-hp">120</span></div>
                    <div class="health-bar">
                        <div class="health-fill" id="tiger-health"></div>
                    </div>
                    <div class="stat"><span>Attack:</span> <span>40</span></div>
                    <div class="stat"><span>Special:</span> <span>Celestial Claw (60)</span></div>
                </div>
            </div>
        </div>

        <div style="display: flex; align-items: center; font-size: 2rem; padding: 0 20px;">
            VS
        </div>

        <!-- Dissonant Arabian Card -->
        <div class="pet-card" style="background-image: url('images/disArabian.jpeg')">
            <div class="pet-info">
                <div class="pet-name">Dissonant Arabian</div>
                <div class="pet-stats">
                    <div class="stat"><span>HP:</span> <span id="arabian-hp">100</span></div>
                    <div class="health-bar">
                        <div class="health-fill" id="arabian-health"></div>
                    </div>
                    <div class="stat"><span>Attack:</span> <span>35</span></div>
                    <div class="stat"><span>Special:</span> <span>Winged Strike (70)</span></div>
                </div>
            </div>
        </div>
    </div>

    <button id="battle-btn" class="battle-btn">Start Battle!</button>
    
    <div id="battle-log" class="battle-log">
        <p>Click "Start Battle!" to begin...</p>
    </div>

    <script>
        // Card stats
        const cards = {
            dissonantTiger: {
                name: "Dissonant Tiger",
                maxHp: 120,
                hp: 120,
                attack: 40,
                special: "Celestial Claw",
                specialDamage: 60
            },
            dissonantArabian: {
                name: "Dissonant Arabian",
                maxHp: 100,
                hp: 100,
                attack: 35,
                special: "Winged Strike",
                specialDamage: 70
            }
        };

        // DOM elements
        const battleBtn = document.getElementById('battle-btn');
        const battleLog = document.getElementById('battle-log');
        const tigerHpDisplay = document.getElementById('tiger-hp');
        const arabianHpDisplay = document.getElementById('arabian-hp');
        const tigerHealthBar = document.getElementById('tiger-health');
        const arabianHealthBar = document.getElementById('arabian-health');

        // Initialize health bars
        updateHealthBars();

        // Battle function
        function battle() {
            // Reset battle
            battleLog.innerHTML = '<p>⚔️ Battle started! ⚔️</p>';
            resetBattle();
            
            // Disable button during battle
            battleBtn.disabled = true;
            battleBtn.textContent = "Battle in progress...";
            
            // Battle loop
            let turn = 0;
            const maxTurns = 20;
            
            const battleInterval = setInterval(() => {
                turn++;
                battleLog.innerHTML += `<p>--- Turn ${turn} ---</p>`;
                
                // Tiger attacks
                const tigerAttack = Math.random() < 0.3 ? 
                    useSpecial(cards.dissonantTiger, cards.dissonantArabian) : 
                    normalAttack(cards.dissonantTiger, cards.dissonantArabian);
                battleLog.innerHTML += tigerAttack;
                updateHealthBars();
                
                // Check if Arabian is defeated
                if(cards.dissonantArabian.hp <= 0) {
                    endBattle(cards.dissonantTiger, cards.dissonantArabian);
                    clearInterval(battleInterval);
                    return;
                }
                
                // Arabian attacks
                const arabianAttack = Math.random() < 0.3 ? 
                    useSpecial(cards.dissonantArabian, cards.dissonantTiger) : 
                    normalAttack(cards.dissonantArabian, cards.dissonantTiger);
                battleLog.innerHTML += arabianAttack;
                updateHealthBars();
                
                // Check if Tiger is defeated
                if(cards.dissonantTiger.hp <= 0) {
                    endBattle(cards.dissonantArabian, cards.dissonantTiger);
                    clearInterval(battleInterval);
                    return;
                }
                
                // Check max turns
                if(turn >= maxTurns) {
                    endBattle(null, null); // Draw
                    clearInterval(battleInterval);
                }
                
                // Auto-scroll log
                battleLog.scrollTop = battleLog.scrollHeight;
            }, 1500); // 1.5 seconds per turn
        }

        // Helper functions
        function normalAttack(attacker, defender) {
            const damage = Math.floor(attacker.attack * (0.8 + Math.random() * 0.4));
            defender.hp = Math.max(0, defender.hp - damage);
            return `<p>${attacker.name} attacks for ${damage} damage!</p>`;
        }

        function useSpecial(attacker, defender) {
            const damage = Math.floor(attacker.specialDamage * (0.8 + Math.random() * 0.4));
            defender.hp = Math.max(0, defender.hp - damage);
            return `<p>✨ ${attacker.name} uses <strong>${attacker.special}</strong> for ${damage} damage!</p>`;
        }

        function updateHealthBars() {
            // Update HP text
            tigerHpDisplay.textContent = cards.dissonantTiger.hp;
            arabianHpDisplay.textContent = cards.dissonantArabian.hp;
            
            // Update health bars
            tigerHealthBar.style.width = `${(cards.dissonantTiger.hp / cards.dissonantTiger.maxHp) * 100}%`;
            arabianHealthBar.style.width = `${(cards.dissonantArabian.hp / cards.dissonantArabian.maxHp) * 100}%`;
            
            // Change color based on health
            tigerHealthBar.style.backgroundColor = getHealthColor(cards.dissonantTiger.hp, cards.dissonantTiger.maxHp);
            arabianHealthBar.style.backgroundColor = getHealthColor(cards.dissonantArabian.hp, cards.dissonantArabian.maxHp);
        }

        function getHealthColor(currentHp, maxHp) {
            const percent = (currentHp / maxHp) * 100;
            if(percent > 60) return "#4CAF50"; // Green
            if(percent > 30) return "#FFC107"; // Yellow
            return "#F44336"; // Red
        }

        function resetBattle() {
            cards.dissonantTiger.hp = cards.dissonantTiger.maxHp;
            cards.dissonantArabian.hp = cards.dissonantArabian.maxHp;
            updateHealthBars();
        }

        function endBattle(winner, loser) {
            if(winner && loser) {
                battleLog.innerHTML += `<p>🎉 <strong>${winner.name}</strong> defeats ${loser.name}!</p>`;
            } else {
                battleLog.innerHTML += `<p>🏳️ The battle ended in a draw!</p>`;
            }
            
            battleBtn.disabled = false;
            battleBtn.textContent = "Battle Again!";
            battleLog.scrollTop = battleLog.scrollHeight;
        }

        // Event listener
        battleBtn.addEventListener('click', battle);
    </script>
</body>
</html>
                                        function resetBattle() {
                                            cards.dissonantTiger.hp = cards.dissonantTiger.maxHp;
                                            cards.dissonantArabian.hp = cards.dissonantArabian.maxHp;
                                            updateHealthBars();
                                        }
                                
                                        function endBattle(winner, loser) {
                                            if(winner && loser) {
                                                battleLog.innerHTML += `<p>🎉 <strong>${winner.name}</strong> defeats ${loser.name}!</p>`;
                                            } else {
                                                battleLog.innerHTML += `<p>🏳️ The battle ended in a draw!</p>`;
                                            }
                                            
                                            battleBtn.disabled = false;
                                            battleBtn.textContent = "Battle Again!";
                                            battleLog.scrollTop = battleLog.scrollHeight;
                                        }
                                
                                        // Event listener
                                        battleBtn.addEventListener('click', battle);
                                    </script>
                                </body>
                                </html>
                                <div class="stat"><span>HP:</span> <span id="arabian-hp">100</span></div>
                                <div class="health-bar">
                                    <div class="health-fill" id="arabian-health"></div>
                                </div>
                                <div class="stat"><span>Attack:</span> <span>35</span></div>
                                <div class="stat"><span>Special:</span> <span>Winged Strike (70)</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            
                <button id="battle-btn" class="battle-btn">Start Battle!</button>
                
                <div id="battle-log" class="battle-log">
                    <p>Click "Start Battle!" to begin...</p>
                </div>
            
                <script>
                    // Card stats
                    const cards = {
                        dissonantTiger: {
                            name: "Dissonant Tiger",
                            maxHp: 120,
                            hp: 120,
                            attack: 40,
                            special: "Celestial Claw",
                            specialDamage: 60
                        },
                        dissonantArabian: {
                            name: "Dissonant Arabian",
                            maxHp: 100,
                            hp: 100,
                            attack: 35,
                            special: "Winged Strike",
                            specialDamage: 70
                        }
                    };
            
                    // DOM elements
                    const battleBtn = document.getElementById('battle-btn');
                    const battleLog = document.getElementById('battle-log');
                    const tigerHpDisplay = document.getElementById('tiger-hp');
                    const arabianHpDisplay = document.getElementById('arabian-hp');
                    const tigerHealthBar = document.getElementById('tiger-health');
                    const arabianHealthBar = document.getElementById('arabian-health');
            
                    // Initialize health bars
                    updateHealthBars();
            
                    // Battle function
                    function battle() {
                        // Reset battle
                        battleLog.innerHTML = '<p>⚔️ Battle started! ⚔️</p>';
                        resetBattle();
                        
                        // Disable button during battle
                        battleBtn.disabled = true;
                        battleBtn.textContent = "Battle in progress...";
                        
                        // Battle loop
                        let turn = 0;
                        const maxTurns = 20;
                        
                        const battleInterval = setInterval(() => {
                            turn++;
                            battleLog.innerHTML += `<p>--- Turn ${turn} ---</p>`;
                            
                            // Tiger attacks
                            const tigerAttack = Math.random() < 0.3 ? 
                                useSpecial(cards.dissonantTiger, cards.dissonantArabian) : 
                                normalAttack(cards.dissonantTiger, cards.dissonantArabian);
                            battleLog.innerHTML += tigerAttack;
                            updateHealthBars();
                            
                            // Check if Arabian is defeated
                            if(cards.dissonantArabian.hp <= 0) {
                                endBattle(cards.dissonantTiger, cards.dissonantArabian);
                                clearInterval(battleInterval);
                                return;
                            }
                            
                            // Arabian attacks
                            const arabianAttack = Math.random() < 0.3 ? 
                                useSpecial(cards.dissonantArabian, cards.dissonantTiger) : 
                                normalAttack(cards.dissonantArabian, cards.dissonantTiger);
                            battleLog.innerHTML += arabianAttack;
                            updateHealthBars();
                            
                            // Check if Tiger is defeated
                            if(cards.dissonantTiger.hp <= 0) {
                                endBattle(cards.dissonantArabian, cards.dissonantTiger);
                                clearInterval(battleInterval);
                                return;
                            }
                            
                            // Check max turns
                            if(turn >= maxTurns) {
                                endBattle(null, null); // Draw
                                clearInterval(battleInterval);
                            }
                            
                            // Auto-scroll log
                            battleLog.scrollTop = battleLog.scrollHeight;
                        }, 1500); // 1.5 seconds per turn
                    }
            
                    // Helper functions
                    function normalAttack(attacker, defender) {
                        const damage = Math.floor(attacker.attack * (0.8 + Math.random() * 0.4));
                        defender.hp = Math.max(0, defender.hp - damage);
                        return `<p>${attacker.name} attacks for ${damage} damage!</p>`;
                    }
            
                    function useSpecial(attacker, defender) {
                        const damage = Math.floor(attacker.specialDamage * (0.8 + Math.random() * 0.4));
                        defender.hp = Math.max(0, defender.hp - damage);
                        return `<p>✨ ${attacker.name} uses <strong>${attacker.special}</strong> for ${damage} damage!</p>`;
                    }
            
                    function updateHealthBars() {
                        // Update HP text
                        tigerHpDisplay.textContent = cards.dissonantTiger.hp;
                        arabianHpDisplay.textContent = cards.dissonantArabian.hp;
                        
                        // Update health bars
                        tigerHealthBar.style.width = `${(cards.dissonantTiger.hp / cards.dissonantTiger.maxHp) * 100}%`;
                        arabianHealthBar.style.width = `${(cards.dissonantArabian.hp / cards.dissonantArabian.maxHp) * 100}%`;
                        
                        // Change color based on health
                        tigerHealthBar.style.backgroundColor = getHealthColor(cards.dissonantTiger.hp, cards.dissonantTiger.maxHp);
                        arabianHealthBar.style.backgroundColor = getHealthColor(cards.dissonantArabian.hp, cards.dissonantArabian.maxHp);
                    }
            
                    function getHealthColor(currentHp, maxHp) {
                        const percent = (currentHp / maxHp) * 100;
                        if(percent > 60) return "#4CAF50"; // Green
                        if(percent > 30) return "#FFC107"; // Yellow
                        return "#F44336"; // Red
                    }
            
                    function resetBattle() {
                        cards.dissonantTiger.hp = cards.dissonantTiger.maxHp;
                        cards.dissonantArabian.hp = cards.dissonantArabian.maxHp;
                        updateHealthBars();
                    }
            
                    function endBattle(winner, loser) {
                        if(winner && loser) {
                            battleLog.innerHTML += `<p>🎉 <strong>${winner.name}</strong> defeats ${loser.name}!</p>`;
                        } else {
                            battleLog.innerHTML += `<p>🏳️ The battle ended in a draw!</p>`;
                        }
                        
                        battleBtn.disabled = false;
                        battleBtn.textContent = "Battle Again!";
                        battleLog.scrollTop = battleLog.scrollHeight;
                    }
            
                    // Event listener
                    battleBtn.addEventListener('click', battle);
                </script>
            </body>
            </html>
            <label for="creature1-select">Fighter 1:</label>
            <select id="creature1-select" class="selector-dropdown">
                <option value="">Loading creatures...</option>
            </select>
        </div>
        <div>
            <label for="creature2-select">Fighter 2:</label>
            <select id="creature2-select" class="selector-dropdown">
                <option value="">Loading creatures...</option>
            </select>
        </div>
    </div>
    
    <div class="battle-arena">
        <div class="creature-container">
            <div id="creature1-card" class="creature-card" style="background-image: url('https://via.placeholder.com/320x450/4ecdc4/ffffff?text=Select+Creature')">
                <div class="creature-info">
                    <div id="creature1-name" class="creature-name">Choose Fighter 1</div>
                    <div id="creature1-tier" class="creature-tier tier-protector">Ready to Battle</div>
                    <div class="creature-stats">
                        <div class="stat-row"><span>HP:</span> <span id="creature1-hp-display">--</span></div>
                        <div class="health-bar-container">
                            <div class="health-bar">
                                <div id="creature1-health" class="health-fill"></div>
                                <div id="creature1-health-text" class="health-text">--/--</div>
                            </div>
                        </div>
                        <div class="stat-row"><span>Attack:</span> <span id="creature1-attack">--</span></div>
                        <div class="stat-row"><span>Special:</span> <span id="creature1-special">--</span></div>
                        <div class="stat-row"><span>Type:</span> <span id="creature1-type">--</span></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="vs-indicator">⚔️</div>

        <div class="creature-container">
            <div id="creature2-card" class="creature-card" style="background-image: url('https://via.placeholder.com/320x450/ff6b6b/ffffff?text=Select+Creature')">
                <div class="creature-info">
                    <div id="creature2-name" class="creature-name">Choose Fighter 2</div>
                    <div id="creature2-tier" class="creature-tier tier-protector">Ready to Battle</div>
                    <div class="creature-stats">
                        <div class="stat-row"><span>HP:</span> <span id="creature2-hp-display">--</span></div>
                        <div class="health-bar-container">
                            <div class="health-bar">
                                <div id="creature2-health" class="health-fill"></div>
                                <div id="creature2-health-text" class="health-text">--/--</div>
                            </div>
                        </div>
                        <div class="stat-row"><span>Attack:</span> <span id="creature2-attack">--</span></div>
                        <div class="stat-row"><span>Special:</span> <span id="creature2-special">--</span></div>
                        <div class="stat-row"><span>Type:</span> <span id="creature2-type">--</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="battle-controls">
        <button id="battle-btn" class="battle-btn" disabled>Select Creatures to Battle!</button>
    </div>
    
    <div id="battle-log" class="battle-log">
        <div class="log-entry">🏛️ Welcome to the Sanctum Battle Arena!</div>
        <div class="log-entry">📋 Select two creatures to witness the power of evolution in combat.</div>
        <div class="log-entry">⚔️ Battle mechanics include tier bonuses, special attacks, and Dissonant ultimates!</div>
        <div id="loading" class="loading-spinner" style="display: none;"></div>
    </div>

    <script>
        // Global variables
        let availableCreatures = [];
        let selectedCreature1 = null;
        let selectedCreature2 = null;
        let battleInProgress = false;

        // DOM elements
        const creature1Select = document.getElementById('creature1-select');
        const creature2Select = document.getElementById('creature2-select');
        const battleBtn = document.getElementById('battle-btn');
        const battleLog = document.getElementById('battle-log');

        // Initialize the arena
        async function initializeArena() {
            showLoading(true);
            await loadCreatures();
            setupEventListeners();
            showLoading(false);
        }

        // Load creatures from backend
        async function loadCreatures() {
            try {
                // First try to load from your actual backend
                const response = await fetch('http://localhost:5000/api/pets');
                if (response.ok) {
                    availableCreatures = await response.json();
                    logMessage('🌟 Successfully loaded creatures from Sanctum database!', 'log-special');
                } else {
                    throw new Error('Backend not available');
                }
            } catch (error) {
                // Fallback to demo data if backend isn't running
                console.log('Using demo data:', error.message);
                availableCreatures = getDemoCreatures();
                logMessage('⚠️ Using demo creatures (backend not connected)', 'log-attack');
            }
            
            populateCreatureSelectors();
        }

        // Demo creatures for when backend isn't running
        function getDemoCreatures() {
            return [
                {
                    _id: 'demo1',
                    name: 'Forest Chimp',
                    species: 'Primate',
                    tier: 'Protector',
                    type: 'Earth',
                    hp: 120,
                    attack: 45,
                    special: 'Vine Swing',
                    specialDamage: 35,
                    baseAttributes: { aggression: 25, intuition: 85, intimidation: 15, intensity: 40 },
                    image: 'chimp_protector.jpg'
                },
                {
                    _id: 'demo2',
                    name: 'Flame Warlord',
                    species: 'Primate',
                    tier: 'Dissonant',
                    type: 'Fire',
                    hp: 450,
                    attack: 280,
                    special: 'Inferno Rage',
                    specialDamage: 320,
                    baseAttributes: { aggression: 95, intuition: 60, intimidation: 90, intensity: 85 },
                    image: 'chimp_dissonant.jpg'
                },
                {
                    _id: 'demo3',
                    name: 'Golden Tiger',
                    species: 'Feline',
                    tier: 'Protector',
                    type: 'Earth',
                    hp: 140,
                    attack: 65,
                    special: 'Pounce Strike',
                    specialDamage: 55,
                    baseAttributes: { aggression: 70, intuition: 50, intimidation: 60, intensity: 55 },
                    image: 'tiger_protector.jpg'
                },
                {
                    _id: 'demo4',
                    name: 'Storm Bear',
                    species: 'Bear',
                    tier: 'Dissonant',
                    type: 'Air',
                    hp: 420,
                    attack: 200,
                    special: 'Lightning Maul',
                    specialDamage: 250,
                    baseAttributes: { aggression: 75, intuition: 70, intimidation: 95, intensity: 85 },
                    image: 'bear_dissonant.jpg'
                }
            ];
        }

        // Populate creature selector dropdowns
        function populateCreatureSelectors() {
            const createOptions = (creatures) => {
                return creatures.map(creature => 
                    `<option value="${creature._id}">${creature.name} (${creature.tier})</option>`
                ).join('');
            };

            const options = '<option value="">Choose a creature...</option>' + createOptions(availableCreatures);
            creature1Select.innerHTML = options;
            creature2Select.innerHTML = options;
        }

        // Setup event listeners
        function setupEventListeners() {
            creature1Select.addEventListener('change', () => selectCreature(1, creature1Select.value));
            creature2Select.addEventListener('change', () => selectCreature(2, creature2Select.value));
            battleBtn.addEventListener('click', startBattle);
        }

        // Select a creature
        function selectCreature(position, creatureId) {
            if (!creatureId) return;

            const creature = availableCreatures.find(c => c._id === creatureId);
            if (!creature) return;

            // Create battle creature with current HP
            const battleCreature = {
                ...creature,
                currentHp: creature.hp,
                maxHp: creature.hp
            };

            if (position === 1) {
                selectedCreature1 = battleCreature;
                updateCreatureDisplay(1, creature);
            } else {
                selectedCreature2 = battleCreature;
                updateCreatureDisplay(2, creature);
            }

            checkBattleReady();
        }

        // Update creature display
        function updateCreatureDisplay(position, creature) {
            const card = document.getElementById(`creature${position}-card`);
            const name = document.getElementById(`creature${position}-name`);
            const tier = document.getElementById(`creature${position}-tier`);
            const hp = document.getElementById(`creature${position}-hp-display`);
            const attack = document.getElementById(`creature${position}-attack`);
            const special = document.getElementById(`creature${position}-special`);
            const type = document.getElementById(`creature${position}-type`);
            const healthBar = document.getElementById(`creature${position}-health`);
            const healthText = document.getElementById(`creature${position}-health-text`);

            // Update background image (with fallback)
            const imageUrl = creature.image ? 
                `images/${creature.image}` : 
                `https://via.placeholder.com/320x450/${getTierColor(creature.tier)}/ffffff?text=${encodeURIComponent(creature.name)}`;
            
            card.style.backgroundImage = `url('${imageUrl}')`;
            
            // Update text content
            name.textContent = creature.name;
            tier.textContent = `${creature.tier} ${creature.species}`;
            tier.className = `creature-tier tier-${creature.tier.toLowerCase()}`;
            hp.textContent = creature.hp;
            attack.textContent = creature.attack;
            special.textContent = `${creature.special} (${creature.specialDamage})`;
            type.textContent = creature.type;
            
            // Update health bar
            healthBar.style.width = '100%';
            healthText.textContent = `${creature.hp}/${creature.hp}`;

            logMessage(`🎯 ${creature.name} enters the arena! (${creature.tier} tier)`, 'log-special');
        }

        // Get tier color for placeholder
        function getTierColor(tier) {
            const colors = {
                'Protector': '4CAF50',
                'Regent': '2196F3', 
                'Shield': 'FF9800',
                'Champion': '9C27B0',
                'Dissonant': 'F44336'
            };
            return colors[tier] || '666666';
        }

        // Check if battle is ready
        function checkBattleReady() {
            if (selectedCreature1 && selectedCreature2 && !battleInProgress) {
                battleBtn.disabled = false;
                battleBtn.textContent = '⚔️ BEGIN BATTLE! ⚔️';
                logMessage(`🔥 Battle ready! ${selectedCreature1.name} vs ${selectedCreature2.name}`, 'log-victory');
            }
        }

        // Start battle
        async function startBattle() {
            if (!selectedCreature1 || !selectedCreature2 || battleInProgress) return;

            battleInProgress = true;
            battleBtn.disabled = true;
            battleBtn.textContent = 'Battle in Progress...';

            // Reset creature HP
            selectedCreature1.currentHp = selectedCreature1.maxHp;
            selectedCreature2.currentHp = selectedCreature2.maxHp;
            updateHealthDisplays();

            logMessage('⚔️🔥 BATTLE COMMENCES! 🔥⚔️', 'log-victory');
            logMessage(`${selectedCreature1.name} (${selectedCreature1.tier}) vs ${selectedCreature2.name} (${selectedCreature2.tier})`, 'log-special');

            // Battle loop
            let turn = 1;
            const maxTurns = 20;

            while (selectedCreature1.currentHp > 0 && selectedCreature2.currentHp > 0 && turn <= maxTurns) {
                logMessage(`--- Turn ${turn} ---`, 'log-attack');
                
                // Creature 1 attacks
                await performAttack(selectedCreature1, selectedCreature2, 1, 2);
                if (selectedCreature2.currentHp <= 0) break;
                
                await delay(1000);
                
                // Creature 2 attacks
                await performAttack(selectedCreature2, selectedCreature1, 2, 1);
                if (selectedCreature1.currentHp <= 0) break;
                
                turn++;
                await delay(1500);
            }

            // End battle
            endBattle();
        }

        // Perform attack
        async function performAttack(attacker, defender, attackerPos, defenderPos) {
            const isSpecial = Math.random() < 0.3;
            const isDissonant = attacker.tier === 'Dissonant';
            const isCritical = Math.random() < 0.15;
            
            let damage;
            let attackType;
            
            if (isSpecial) {
                damage = Math.floor(attacker.specialDamage * (0.8 + Math.random() * 0.4));
                attackType = 'special';
                
                if (isDissonant) {
                    damage = Math.floor(damage * 1.5); // Dissonant bonus
                    triggerDissonantEffects();
                }
                
                logMessage(`✨ ${attacker.name} unleashes ${attacker.special}!`, 'log-special');
                triggerCardEffect(attackerPos, 'special');
            } else {
                damage = Math.floor(attacker.attack * (0.8 + Math.random() * 0.4));
                attackType = 'normal';
                logMessage(`⚔️ ${attacker.name} attacks!`, 'log-attack');
                triggerCardEffect(attackerPos, 'hit');
            }
            
            if (isCritical) {
                damage = Math.floor(damage * 1.5);
                attackType = 'critical';
                logMessage(`💥 CRITICAL HIT!`, 'log-victory');
            }
            
            // Apply damage
            defender.currentHp = Math.max(0, defender.currentHp - damage);
            
            // Visual effects
            await createFloatingDamage(defenderPos, damage, attackType);
            triggerCardEffect(defenderPos, 'hit');
            updateHealthDisplays();
            
            // Log damage
            const damageText = isCritical ? `💥 ${damage} CRITICAL damage!` : `${damage} damage!`;
            logMessage(`${defender.name} takes ${damageText}`, 'log-damage');
            
            if (defender.currentHp <= 0) {
                logMessage(`💀 ${defender.name} is defeated!`, 'log-victory');
            }
            
            await delay(800);
        }

        // Create floating damage effect
        function createFloatingDamage(position, damage, type) {
            const card = document.getElementById(`creature${position}-card`);
            const container = card.parentElement;
            
            const floatingDiv = document.createElement('div');
            floatingDiv.className = `floating-damage damage-${type}`;
            
            let damageText = `-${damage}`;
            if (type === 'special') damageText = `✨ -${damage}`;
            if (type === 'critical') damageText = `💥 -${damage}!`;
            
            floatingDiv.textContent = damageText;
            
            // Position randomly around the card
            const randomX = (Math.random() - 0.5) * 100;
            const randomY = (Math.random() - 0.5) * 50;
            floatingDiv.style.left = `50%`;
            floatingDiv.style.top = `30%`;
            floatingDiv.style.transform = `translate(${randomX}px, ${randomY}px)`;
            
            container.appendChild(floatingDiv);
            
            // Remove after animation
            setTimeout(() => {
                if (floatingDiv.parentNode) {
                    floatingDiv.parentNode.removeChild(floatingDiv);
                }
            }, 2000);
            
            return new Promise(resolve => setTimeout(resolve, 500));
        }

        // Trigger card effects
        function triggerCardEffect(position, effectType) {
            const card = document.getElementById(`creature${position}-card`);
            
            // Remove existing classes
            card.classList.remove('card-hit', 'card-special', 'card-dissonant');
            
            // Add new effect
            if (effectType === 'special') {
                card.classList.add('card-special');
            } else if (effectType === 'dissonant') {
                card.classList.add('card-dissonant');
            } else {
                card.classList.add('card-hit');
            }
            
            // Remove effect after animation
            setTimeout(() => {
                card.classList.remove('card-hit', 'card-special', 'card-dissonant');
            }, 2000);
        }

        // Trigger Dissonant ultimate effects
        function triggerDissonantEffects() {
            // Screen flash
            const flash = document.createElement('div');
            flash.className = 'screen-flash';
            document.body.appendChild(flash);
            setTimeout(() => document.body.removeChild(flash), 500);
            
            // Screen shake
            document.body.classList.add('screen-shake');
            setTimeout(() => document.body.classList.remove('screen-shake'), 800);
            
            logMessage('🌟 DISSONANT POWER UNLEASHED! 🌟', 'log-victory');
        }

        // Update health displays
        function updateHealthDisplays() {
            updateCreatureHealth(1, selectedCreature1);
            updateCreatureHealth(2, selectedCreature2);
        }

        // Update individual creature health
        function updateCreatureHealth(position, creature) {
            const healthBar = document.getElementById(`creature${position}-health`);
            const healthText = document.getElementById(`creature${position}-health-text`);
            const hpDisplay = document.getElementById(`creature${position}-hp-display`);
            
            const healthPercent = (creature.currentHp / creature.maxHp) * 100;
            
            healthBar.style.width = `${healthPercent}%`;
            healthText.textContent = `${creature.currentHp}/${creature.maxHp}`;
            hpDisplay.textContent = creature.currentHp;
            
            // Change health bar color based on health
            if (healthPercent > 60) {
                healthBar.style.background = 'linear-gradient(90deg, #4CAF50, #8BC34A)';
            } else if (healthPercent > 30) {
                healthBar.style.background = 'linear-gradient(90deg, #FFC107, #FFD54F)';
            } else {
                healthBar.style.background = 'linear-gradient(90deg, #F44336, #FF8A80)';
            }
        }

        // End battle
        function endBattle() {
            battleInProgress = false;
            
            let winner, loser;
            if (selectedCreature1.currentHp > 0 && selectedCreature2.currentHp <= 0) {
                winner = selectedCreature1;
                loser = selectedCreature2;
            } else if (selectedCreature2.currentHp > 0 && selectedCreature1.currentHp <= 0) {
                winner = selectedCreature2;
                loser = selectedCreature1;
            } else {
                logMessage('🏳️ Battle ended in a draw!', 'log-victory');
                resetBattleControls();
                return;
            }
            
            logMessage(`🎉 VICTORY! ${winner.name} emerges triumphant!`, 'log-victory');
            logMessage(`🏆 ${winner.name} (${winner.tier}) defeats ${loser.name} (${loser.tier})`, 'log-special');
            
            // Calculate battle stats
            const totalDamageDealt = winner.maxHp - winner.currentHp + loser.maxHp;
            const battleDuration = Date.now();
            logMessage(`📊 Battle Stats: ${totalDamageDealt} total damage dealt`, 'log-attack');
            
            resetBattleControls();
        }

        // Reset battle controls
        function resetBattleControls() {
            battleBtn.disabled = false;
            battleBtn.textContent = '⚔️ BATTLE AGAIN! ⚔️';
            
            // Reset creature HP for next battle
            if (selectedCreature1) selectedCreature1.currentHp = selectedCreature1.maxHp;
            if (selectedCreature2) selectedCreature2.currentHp = selectedCreature2.maxHp;
            updateHealthDisplays();
        }

        // Utility functions
        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function logMessage(message, className = 'log-entry') {
            const logDiv = document.createElement('div');
            logDiv.className = `log-entry ${className}`;
            logDiv.textContent = message;
            
            battleLog.appendChild(logDiv);
            battleLog.scrollTop = battleLog.scrollHeight;
            
            // Limit log entries to prevent memory issues
            const entries = battleLog.querySelectorAll('.log-entry');
            if (entries.length > 50) {
                entries[0].remove();
            }
        }

        function showLoading(show) {
            const spinner = document.getElementById('loading');
            if (spinner) {
                spinner.style.display = show ? 'block' : 'none';
            }
        }

        // Initialize the arena when page loads
        document.addEventListener('DOMContentLoaded', initializeArena);
    </script>
</body>
</html>